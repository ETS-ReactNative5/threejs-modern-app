!function(e){function t(t){for(var n,a,s=t[0],c=t[1],u=t[2],f=0,p=[];f<s.length;f++)a=s[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);p.length;)p.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==o[c]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},o={0:0},i=[];function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([246,1]),r()}({190:function(e,t){},246:function(e,t,r){"use strict";r.r(t);r(61),r(34),r(71),r(101);var n,o=r(29),i=(r(55),r(76),r(35),r(155),r(106),r(37),r(81),r(57),r(108),r(109),r(157),r(0)),a=r(133),s=r(134),c=r.n(s),u=r(135),l=r.n(u),f=r(136),p=r(143),d=r(137),v=r.n(d),m=(r(114),r(116),r(117),r(171),r(172),r(174),r(175),r(176),r(90)),h=r.n(m),y=r(138),g=r.n(y);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){return Object.fromEntries(Object.entries(e).map((function(e,r){var n=O(e,2),o=n[0],i=n[1];return[o,t(i,o,r)]})))}function S(e){return h.a.Slider(e.value,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({min:e.min,max:e.max,step:e.step||.01},"exp"===e.scale&&{min:e.min||.01,mapping:function(e){return Math.pow(10,e)},inverseMapping:Math.log10}))}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=j(e,(function(e){return"object"===b(e)&&(e.hasOwnProperty("value")||e.hasOwnProperty("max")||e.hasOwnProperty("min")||e.hasOwnProperty("step"))?S(e):"object"===b(e)?j(e,(function(t){return"object"===b(t)&&(t.hasOwnProperty("value")||t.hasOwnProperty("max")||t.hasOwnProperty("min")||t.hasOwnProperty("step"))?S(t):e})):e})),o=h()(r),i=t.hideControls?o:g()(o,{expanded:!t.closeControls});if(!t.hideControls){var a='\n      [class^="controlPanel-"] [class*="__field"]::before {\n        content: initial !important;\n      }\n      [class^="controlPanel-"] [class*="__labelText"] {\n        text-indent: 6px !important;\n      }\n      [class^="controlPanel-"] [class*="__field--button"] > button::before {\n        content: initial !important;\n      }\n    ',s=document.createElement("style");s.type="text/css",s.innerHTML=a,document.head.appendChild(s)}return n=i,i}function _(e){"}"===e.slice(-1)&&(e=e.slice(0,-1));var t=e.indexOf(".controls.")+".controls.".length;return(e=e.slice(t)).trim()}function E(e,t){var r=_(t.toString());return n.$onChanges((function(t){t[r]&&(e[r]=t[r].value)})),t()}function T(e,t){var r=_(t.toString()),o=r.includes(".")?r.slice(r.lastIndexOf(".")+1):r;return n.$onChanges((function(t){t[r]&&(e.uniforms[o].value=t[r].value)})),{value:t()}}function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function U(e,t,r){return t&&I(e.prototype,t),r&&I(e,r),e}function A(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var G=0;function L(e){return"__private_"+G+++"_"+e}var z=L("width"),F=L("height"),Y=L("capturer"),N=L("lastTime"),q=L("updateListeners"),V=L("pointerdownListeners"),J=L("pointermoveListeners"),W=L("pointerupListeners"),X=L("startX"),$=L("startY"),K=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.background,s=void 0===n?"#111":n,c=r.backgroundAlpha,u=void 0===c?1:c,d=r.fov,m=void 0===d?45:d,h=r.frustumSize,y=void 0===h?3:h,g=r.near,b=void 0===g?.01:g,w=r.far,x=void 0===w?100:w,O=D(r,["background","backgroundAlpha","fov","frustumSize","near","far"]);B(this,e),Object.defineProperty(this,z,{writable:!0,value:void 0}),Object.defineProperty(this,F,{writable:!0,value:void 0}),Object.defineProperty(this,Y,{writable:!0,value:void 0}),this.isRunning=!1,this.time=0,this.dt=0,Object.defineProperty(this,N,{writable:!0,value:performance.now()}),Object.defineProperty(this,q,{writable:!0,value:[]}),Object.defineProperty(this,V,{writable:!0,value:[]}),Object.defineProperty(this,J,{writable:!0,value:[]}),Object.defineProperty(this,W,{writable:!0,value:[]}),Object.defineProperty(this,X,{writable:!0,value:void 0}),Object.defineProperty(this,$,{writable:!0,value:void 0}),this.resize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.width,n=void 0===r?t.width:r,o=e.height,i=void 0===o?t.height:o,a=e.pixelRatio,s=void 0===a?t.pixelRatio:a;if(t.renderer.getPixelRatio()!==s&&t.renderer.setPixelRatio(s),t.renderer.setSize(n,i),t.camera.isPerspectiveCamera)t.camera.aspect=n/i;else{var c=n/i;t.camera.left=-t.camera.frustumSize*c/2,t.camera.right=t.camera.frustumSize*c/2,t.camera.top=t.camera.frustumSize/2,t.camera.bottom=-t.camera.frustumSize/2}return t.camera.updateProjectionMatrix(),t.composer&&t.composer.setSize(),t.scene.traverse((function(e){"function"==typeof e.resize&&e.resize({width:n,height:i,pixelRatio:s})})),t.draw(),t},this.saveScreenshot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.width,n=void 0===r?1920:r,o=e.height,i=void 0===o?1080:o,a=e.fileName,s=void 0===a?"Screenshot.png":a;t.resize({width:n,height:i,pixelRatio:1}),t.draw();var c=t.canvas.toDataURL("image/png");t.resize(),t.draw(),Q(s,c)},this.startRecording=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.width,n=void 0===r?1920:r,o=e.height,i=void 0===o?1080:o,a=e.fileName,s=void 0===a?"Recording":a,c=e.format,u=void 0===c?"gif":c,l=D(e,["width","height","fileName","format"]);A(t,Y)[Y]||(t.resize({width:n,height:i,pixelRatio:1}),t.draw(),A(t,Y)[Y]=new v.a(C({format:u,name:s,workersPath:"",motionBlurFrames:2},l)),A(t,Y)[Y].start())},this.stopRecording=function(){A(t,Y)[Y]&&(A(t,Y)[Y].stop(),A(t,Y)[Y].save(),A(t,Y)[Y]=void 0,t.resize(),t.draw())},this.update=function(e,r,n){return t.orbitControls&&t.orbitControls.update(),t.scene.traverse((function(t){"function"!=typeof t.update||t.isTransformControls||t.update(e,r,n)})),t.world&&(t.world.step(1/60,e),t.cannonDebugger&&t.cannonDebugger.update(),t.world.bodies.forEach((function(t){"function"==typeof t.update&&t.update(e,r)}))),A(t,q)[q].forEach((function(t){return t(e,r,n)})),t},this.draw=function(){return t.composer?t.composer.render(t.dt):t.renderer.render(t.scene,t.camera),t},this.start=function(){if(!t.isRunning)return t.renderer.setAnimationLoop(t.animate),t.isRunning=!0,t},this.stop=function(){if(t.isRunning)return t.renderer.setAnimationLoop(null),t.isRunning=!1,t},this.animate=function(e,r){t.isRunning&&(t.stats&&t.stats.begin(),t.dt=Math.min(t.maxDeltaTime,(e-A(t,N)[N])/1e3),t.time+=t.dt,A(t,N)[N]=e,t.update(t.dt,t.time,r),t.draw(),A(t,Y)[Y]&&A(t,Y)[Y].capture(t.canvas),t.stats&&t.stats.end())},this.renderer=new i.jc(C({antialias:!O.postprocessing,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0},O)),void 0!==O.sortObjects&&(this.renderer.sortObjects=O.sortObjects),O.gamma&&(this.renderer.outputEncoding=i.kc),O.xr&&(this.renderer.xr.enabled=!0),this.canvas=this.renderer.domElement,this.renderer.setClearColor(s,u),A(this,z)[z]=O.width,A(this,F)[F]=O.height,this.maxPixelRatio=O.maxPixelRatio||2,this.maxDeltaTime=O.maxDeltaTime||1/30;var P=A(this,z)[z]/A(this,F)[F];if(O.orthographic?(this.camera=new i.pb(-y*P/2,y*P/2,y/2,-y/2,b,x),this.camera.frustumSize=y):this.camera=new i.rb(m,P,b,x),this.camera.position.copy(O.cameraPosition||new i.dc(0,0,4)),this.camera.lookAt(0,0,0),this.scene=new i.Jb,this.gl=this.renderer.getContext(),window.addEventListener("resize",this.resize),window.addEventListener("orientationchange",this.resize),this.resize(),this.isDragging=!1,this.canvas.addEventListener("pointerdown",(function(e){e.isPrimary&&(t.isDragging=!0,A(t,X)[X]=e.offsetX,A(t,$)[$]=e.offsetY,t.scene.traverse((function(t){"function"==typeof t.onPointerDown&&t.onPointerDown(e,{x:e.offsetX,y:e.offsetY})})),A(t,V)[V].forEach((function(t){return t(e,{x:e.offsetX,y:e.offsetY})})))})),this.canvas.addEventListener("pointermove",(function(e){if(e.isPrimary){var r=C(C({x:e.offsetX,y:e.offsetY},void 0!==A(t,X)[X]&&{dragX:e.offsetX-A(t,X)[X]}),void 0!==A(t,$)[$]&&{dragY:e.offsetY-A(t,$)[$]});t.scene.traverse((function(t){"function"==typeof t.onPointerMove&&t.onPointerMove(e,r)})),A(t,J)[J].forEach((function(t){return t(e,r)}))}})),this.canvas.addEventListener("pointerup",(function(e){if(e.isPrimary){t.isDragging=!1;var r=C(C({x:e.offsetX,y:e.offsetY},void 0!==A(t,X)[X]&&{dragX:e.offsetX-A(t,X)[X]}),void 0!==A(t,$)[$]&&{dragY:e.offsetY-A(t,$)[$]});t.scene.traverse((function(t){"function"==typeof t.onPointerUp&&t.onPointerUp(e,r)})),A(t,W)[W].forEach((function(t){return t(e,r)})),A(t,X)[X]=void 0,A(t,$)[$]=void 0}})),O.postprocessing){var j=this.gl.getParameter(this.gl.MAX_SAMPLES);this.composer=new o.a(this.renderer,C({multisampling:Math.min(8,j),frameBufferType:O.gamma?i.D:void 0},O)),this.composer.addPass(new o.d(this.scene,this.camera))}O.orbitControls&&(this.orbitControls=new a.a(this.camera,this.canvas),this.orbitControls.enableDamping=!0,this.orbitControls.dampingFactor=.15,this.orbitControls.enablePan=!1,O.orbitControls instanceof Object&&Object.keys(O.orbitControls).forEach((function(e){t.orbitControls[e]=O.orbitControls[e]}))),O.world&&(this.world=O.world,O.showWorldWireframes&&(this.cannonDebugger=Object(p.a)(this.scene,this.world.bodies,{autoUpdate:!1}))),O.showFps&&(this.stats=new l.a,this.stats.showPanel(0),document.body.appendChild(this.stats.dom)),O.controls&&(this.controls=M(O.controls,O)),this.loadGPUTier=Object(f.a)({glContext:this.gl}).then((function(e){t.gpu={name:e.gpu,tier:e.tier,isMobile:e.isMobile,fps:e.fps}}))}return U(e,[{key:"background",get:function(){return this.render.getClearColor(new i.j)}},{key:"backgroundAlpha",get:function(){return this.render.getClearAlpha()}},{key:"isRecording",get:function(){return Boolean(A(this,Y)[Y])}}]),U(e,[{key:"onUpdate",value:function(e){A(this,q)[q].push(e)}},{key:"onPointerDown",value:function(e){A(this,V)[V].push(e)}},{key:"onPointerMove",value:function(e){A(this,J)[J].push(e)}},{key:"onPointerUp",value:function(e){A(this,W)[W].push(e)}},{key:"offUpdate",value:function(e){var t=A(this,q)[q].indexOf(e);-1!==t&&A(this,q)[q].splice(t,1)}},{key:"offPointerDown",value:function(e){var t=A(this,V)[V].indexOf(e);-1!==t&&A(this,V)[V].splice(t,1)}},{key:"offPointerMove",value:function(e){var t=A(this,J)[J].indexOf(e);-1!==t&&A(this,J)[J].splice(t,1)}},{key:"offPointerUp",value:function(e){var t=A(this,W)[W].indexOf(e);-1!==t&&A(this,W)[W].splice(t,1)}},{key:"width",get:function(){return A(this,z)[z]||window.innerWidth}},{key:"height",get:function(){return A(this,F)[F]||window.innerHeight}},{key:"pixelRatio",get:function(){return Math.min(this.maxPixelRatio,window.devicePixelRatio)}},{key:"cursor",get:function(){return this.canvas.style.cursor},set:function(e){this.canvas.style.cursor=e||null}}]),e}();function Q(e,t){var r=c()(t),n=document.createElement("a");n.download=e,n.href=window.URL.createObjectURL(r),n.onclick=setTimeout((function(){window.URL.revokeObjectURL(r),n.removeAttribute("href")}),0),n.click()}r(38),r(180),r(181),r(84),r(87);var H=r(139),Z=r.n(H),ee=r(60),te=r.n(ee),re=r(59),ne=r(140);r(88),r(192);function oe(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function ie(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){oe(i,n,o,a,s,"next",e)}function s(e){oe(i,n,o,a,s,"throw",e)}a(void 0)}))}}function ae(e,t){return se.apply(this,arguments)}function se(){return(se=ie(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new i.Ub).name=t,n.encoding=r.encoding||i.P,ce(t,n,r),e.prev=4,e.next=7,Object(re.a)(t,{crossorigin:"anonymous"});case 7:return o=e.sent,n.image=o,n.needsUpdate=!0,r.renderer&&r.renderer.initTexture(n),e.abrupt("return",n);case 14:throw e.prev=14,e.t0=e.catch(4),new Error("Could not load texture ".concat(t));case 17:case"end":return e.stop()}}),e,null,[[4,14]])})))).apply(this,arguments)}function ce(e,t,r){if("boolean"==typeof r.flipY&&(t.flipY=r.flipY),void 0!==r.mapping&&(t.mapping=r.mapping),void 0!==r.format)t.format=r.format;else{var n=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data:image\/jpeg/);t.format=n?i.Eb:i.Bb}r.repeat&&t.repeat.copy(r.repeat),t.wrapS=r.wrapS||i.i,t.wrapT=r.wrapT||i.i,t.minFilter=r.minFilter||i.R,t.magFilter=r.magFilter||i.Q,t.generateMipmaps=!1!==r.generateMipmaps}r(89);var ue=r(141),le=r.n(ue),fe=r(144);function pe(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function de(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){pe(i,n,o,a,s,"next",e)}function s(e){pe(i,n,o,a,s,"throw",e)}a(void 0)}))}}function ve(){return(ve=de(regeneratorRuntime.mark((function e(t,r){var n,o,a,s,c,u,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.renderer){e.next=3;break}throw new Error("Env map requires renderer to passed in the options for ".concat(t,"!"));case 3:if(!r.equirectangular){e.next=17;break}return e.next=6,ae(t,{renderer:n});case 6:if(o=e.sent,!r.pmrem){e.next=11;break}return e.abrupt("return",he(o,n));case 11:return a=le()(o.image.naturalHeight),s=new i.gc(a,{generateMipmaps:!0,minFilter:i.S,magFilter:i.Q}),c=s.fromEquirectangularTexture(n,o).texture,o.dispose(),o.image.data=null,e.abrupt("return",c);case 17:if(u=t,l=r.extension||".jpg",f=ye("".concat(u.replace(/\/$/,""),"/"),l),".hdr"!==l){e.next=22;break}return e.abrupt("return",new Promise((function(e,t){(new fe.a).load(i.Zb,f,(function(t){return e(me(t,r))}),null,(function(){return t(new Error("Could not load env map: ".concat(u)))}))})));case 22:return e.abrupt("return",new Promise((function(e,t){(new i.l).load(f,(function(t){return e(me(t,r))}),null,(function(){return t(new Error("Could not load env map: ".concat(u)))}))})));case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e,t){return t.encoding&&(e.encoding=t.encoding),t.format&&(e.format=t.format),t.pmrem&&(e=function(e,t){var r=new i.qb(t);r.compileCubemapShader();var n=r.fromCubemap(e);return r.dispose(),e.dispose(),e.image.data=null,n.texture}(e,t.renderer)),e}function he(e,t){var r=new i.qb(t);r.compileEquirectangularShader();var n=r.fromEquirectangular(e);return r.dispose(),e.dispose(),e.image.data=null,n.texture}function ye(e,t){return["".concat(e,"px").concat(t),"".concat(e,"nx").concat(t),"".concat(e,"py").concat(t),"".concat(e,"ny").concat(t),"".concat(e,"pz").concat(t),"".concat(e,"nz").concat(t)]}function ge(e){return function(e){if(Array.isArray(e))return be(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return be(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return be(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function we(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function xe(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){we(i,n,o,a,s,"next",e)}function s(e){we(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){je(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Se(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _e(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var Ee=0;function Te(e){return"__private_"+Ee+++"_"+e}var ke=Te("queue"),Ce=Te("cache"),Re=Te("onProgressListeners"),De=Te("asyncConcurrency"),Be=Te("logs"),Ie=new(function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,ke,{writable:!0,value:[]}),Object.defineProperty(this,Ce,{writable:!0,value:{}}),Object.defineProperty(this,Re,{writable:!0,value:[]}),Object.defineProperty(this,De,{writable:!0,value:10}),Object.defineProperty(this,Be,{writable:!0,value:[]}),this.get=function(e){if(!e)throw new TypeError("Must specify an URL for AssetManager.get()");return _e(t,Ce)[Ce][e]}}var t,r,n,o,i;return t=e,(r=[{key:"addProgressListener",value:function(e){if("function"!=typeof e)throw new TypeError("onProgress must be a function");_e(this,Re)[Re].push(e)}},{key:"queue",value:function(e){var t=e.url,r=e.type,n=Se(e,["url","type"]);if(!t)throw new TypeError("Must specify a URL or opt.url for AssetManager.queue()");return this._getQueued(t)||_e(this,ke)[ke].push(Pe({url:t,type:r||this._extractType(t)},n)),t}},{key:"_getQueued",value:function(e){return _e(this,ke)[ke].find((function(t){return t.url===e}))}},{key:"_extractType",value:function(e){var t=e.slice(e.lastIndexOf("."));switch(!0){case/\.(gltf|glb)$/i.test(t):return"gltf";case/\.json$/i.test(t):return"json";case/\.svg$/i.test(t):return"svg";case/\.(jpe?g|png|gif|bmp|tga|tif)$/i.test(t):return"image";case/\.(wav|mp3)$/i.test(t):return"audio";case/\.(mp4|webm|ogg|ogv)$/i.test(t):return"video";default:throw new Error("Could not load ".concat(e,", unknown file extension!"))}}},{key:"loadSingle",value:(i=xe(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.renderer,n=Se(t,["renderer"]),r){e.next=3;break}throw new Error("You must provide a renderer to the loadSingle function.");case 3:return e.prev=3,o=Date.now(),e.next=7,this._loadItem(Pe({renderer:r},n));case 7:return _e(this,Ce)[Ce][n.url]=e.sent,window.DEBUG&&console.log("\ud83d\udce6 Loaded single asset %c".concat(n.url,"%c in ").concat(te()(Date.now()-o)),"color:blue","color:black"),e.abrupt("return",n.url);case 12:e.prev=12,e.t0=e.catch(3),delete _e(this,Ce)[Ce][n.url],console.error("\ud83d\udce6 Asset ".concat(n.url," was not loaded:\n").concat(e.t0));case 16:case"end":return e.stop()}}),e,this,[[3,12]])}))),function(e){return i.apply(this,arguments)})},{key:"load",value:(o=xe(regeneratorRuntime.mark((function e(t){var r,n,o,i,a,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.renderer){e.next=3;break}throw new Error("You must provide a renderer to the load function.");case 3:if(n=_e(this,ke)[ke].slice(),_e(this,ke)[ke].length=0,0!==(o=n.length)){e.next=9;break}return setTimeout((function(){return _e(s,Re)[Re].forEach((function(e){return e(1)}))}),0),e.abrupt("return");case 9:return i=Date.now(),e.next=12,Z()(n,function(){var e=xe(regeneratorRuntime.mark((function e(t,n){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=Date.now(),e.next=4,s._loadItem(Pe({renderer:r},t));case 4:_e(s,Ce)[Ce][t.url]=e.sent,window.DEBUG&&s.log("Loaded %c".concat(t.url,"%c in ").concat(te()(Date.now()-i)),"color:blue","color:black"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),s.logError("Asset ".concat(t.url," was not loaded:\n").concat(e.t0));case 11:a=(n+1)/o,_e(s,Re)[Re].forEach((function(e){return e(a)}));case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r){return e.apply(this,arguments)}}(),{concurrency:_e(this,De)[De]});case 12:window.DEBUG&&(0===(a=_e(this,Be)[Be].filter((function(e){return"error"===e.type}))).length?this.groupLog("\ud83d\udce6 Assets loaded in ".concat(te()(Date.now()-i)," \u23f1")):this.groupLog("\ud83d\udce6 %c Could not load ".concat(a.length," asset").concat(a.length>1?"s":""," "),"color:white;background:red;"));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"_loadItem",value:function(e){var t=e.url,r=e.type,n=e.renderer,o=Se(e,["url","type","renderer"]);if(t in _e(this,Ce)[Ce])return _e(this,Ce)[Ce][t];switch(r){case"gltf":return new Promise((function(e,r){(new ne.a).load(t,e,null,(function(e){return r(new Error("Could not load GLTF asset ".concat(t,":\n").concat(e)))}))}));case"json":return fetch(t).then((function(e){return e.json()}));case"env-map":return function(e,t){return ve.apply(this,arguments)}(t,Pe({renderer:n},o));case"svg":case"image":return Object(re.a)(t,{crossorigin:"anonymous"});case"texture":return ae(t,Pe({renderer:n},o));case"audio":return fetch(t).then((function(e){return e.arrayBuffer()}));case"video":return fetch(t).then((function(e){return e.blob()}));default:throw new Error("Could not load ".concat(t,", the type ").concat(r," is unknown!"))}}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];_e(this,Be)[Be].push({type:"log",text:t})}},{key:"logError",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];_e(this,Be)[Be].push({type:"error",text:t})}},{key:"groupLog",value:function(){var e;(e=console).groupCollapsed.apply(e,arguments),_e(this,Be)[Be].forEach((function(e){var t;(t=console)[e.type].apply(t,ge(e.text))})),console.groupEnd(),_e(this,Be)[Be].length=0}}])&&Me(t.prototype,r),n&&Me(t,n),e}());r(123),r(124),r(194),r(195);function Ue(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Ae(e,t){var r=t.defines,n=void 0===r?"":r,o=t.head,i=void 0===o?"":o,a=t.main,s=void 0===a?"":a,c=t.objectNormal,u=t.transformed,l=Ue(t,["defines","head","main","objectNormal","transformed"]),f=e;Object.keys(l).forEach((function(e){var t,r,n;t=f,r=e,n=l[e],f=t.split(r).join(n)})),f=f.replace("void main() {","\n    ".concat(i,"\n    void main() {\n      ").concat(s,"\n    ")),u&&f.includes("#include <begin_vertex>")&&(f=f.replace("#include <begin_vertex>","#include <begin_vertex>\n      ".concat(u,"\n      "))),c&&f.includes("#include <beginnormal_vertex>")&&(f=f.replace("#include <beginnormal_vertex>","#include <beginnormal_vertex>\n      ".concat(c,"\n      ")));var p=Object.keys(n).map((function(e){return"#define ".concat(e," ").concat(n[e])})).join("\n");return"\n    ".concat(p,"\n    ").concat(f,"\n  ")}function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=qe(e);if(t){var o=qe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ne(this,r)}}function Ne(e,t){return!t||"object"!==Ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ve=Ie.queue({url:"assets/suzanne.gltf",type:"gltf"}),Je=Ie.queue({url:"assets/spotty-metal/albedo.jpg",type:"texture"}),We=Ie.queue({url:"assets/spotty-metal/metalness.jpg",type:"texture"}),Xe=Ie.queue({url:"assets/spotty-metal/roughness.jpg",type:"texture"}),$e=Ie.queue({url:"assets/spotty-metal/normal.jpg",type:"texture"}),Ke=Ie.queue({url:"assets/ouside-afternoon-blurred-hdr.jpg",type:"env-map",equirectangular:!0}),Qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(a,e);var t,r,n,o=Ye(a);function a(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Le(this,a),(t=o.call(this,r)).webgl=e,t.options=r;var n=Ie.get(Ve),s=n.scene.clone(),c=Ie.get(Je),u=Ie.get(Ke);c.encoding=i.kc,u.encoding=i.kc;var l=new i.ib({map:c,metalnessMap:Ie.get(We),roughnessMap:Ie.get(Xe),normalMap:Ie.get($e),normalScale:new i.cc(2,2),envMap:u,roughness:e.controls.roughness,metalness:1});return t.material=l,E(l,(function(){return e.controls.roughness})),l.onBeforeCompile=function(t){l.uniforms=t.uniforms,t.uniforms.time={value:0},t.uniforms.frequency=T(t,(function(){return e.controls.movement.frequency})),t.uniforms.amplitude=T(t,(function(){return e.controls.movement.amplitude})),t.vertexShader=Ae(t.vertexShader,{head:"\n          uniform float time;\n          uniform float frequency;\n          uniform float amplitude;\n\n          // you could import glsl packages like this\n          // #pragma glslify: noise = require(glsl-noise/simplex/3d)\n        ",main:"\n          float theta = sin(position.z * frequency + time) * amplitude;\n          float c = cos(theta);\n          float s = sin(theta);\n          mat3 deformMatrix = mat3(c, 0, s, 0, 1, 0, -s, 0, c);\n        ",objectNormal:"\n          objectNormal *= deformMatrix;\n        ",transformed:"\n          transformed *= deformMatrix;\n        "})},s.traverse((function(e){e.isMesh&&(e.material=l)})),s.scale.multiplyScalar(1.2),t.add(s),t.webgl.scene.background=u,t}return t=a,(r=[{key:"onPointerDown",value:function(e,t){var r=t.x,n=t.y,o=(new i.cc).set(r/this.webgl.width*2-1,-n/this.webgl.height*2+1),a=new i.Gb;a.setFromCamera(o,this.webgl.camera);var s=a.intersectObject(this,!0);console.log(s.length>0?"Hit ".concat(s[0].object.name,"!"):"No hit")}},{key:"onPointerMove",value:function(e,t){t.x,t.y}},{key:"onPointerUp",value:function(e,t){t.x,t.y}},{key:"update",value:function(e,t){this.material.uniforms&&(this.material.uniforms.time.value+=e*this.webgl.controls.movement.speed)}}])&&ze(t.prototype,r),n&&ze(t,n),a}(i.C);r(196),r(198),r(202),r(207),r(209),r(210),r(211),r(212),r(213),r(214),r(215),r(216),r(217),r(218),r(219),r(220),r(221),r(222),r(223),r(224),r(225),r(226),r(227),r(228),r(229),r(230),r(231),r(233),r(234),r(235),r(236),r(237),r(239),r(240),r(241),r(242),r(243),r(244),r(245);var He=r(142),Ze="\n  #ifdef USE_SKINNING\n  #ifdef BONE_TEXTURE\n    uniform sampler2D prevBoneTexture;\n    mat4 getPrevBoneMatrix( const in float i ) {\n      float j = i * 4.0;\n      float x = mod( j, float( boneTextureSize ) );\n      float y = floor( j / float( boneTextureSize ) );\n      float dx = 1.0 / float( boneTextureSize );\n      float dy = 1.0 / float( boneTextureSize );\n      y = dy * ( y + 0.5 );\n      vec4 v1 = texture2D( prevBoneTexture, vec2( dx * ( x + 0.5 ), y ) );\n      vec4 v2 = texture2D( prevBoneTexture, vec2( dx * ( x + 1.5 ), y ) );\n      vec4 v3 = texture2D( prevBoneTexture, vec2( dx * ( x + 2.5 ), y ) );\n      vec4 v4 = texture2D( prevBoneTexture, vec2( dx * ( x + 3.5 ), y ) );\n      mat4 bone = mat4( v1, v2, v3, v4 );\n      return bone;\n    }\n  #else\n    uniform mat4 prevBoneMatrices[ MAX_BONES ];\n    mat4 getPrevBoneMatrix( const in float i ) {\n      mat4 bone = prevBoneMatrices[ int(i) ];\n      return bone;\n    }\n  #endif\n  #endif\n",et="\n  vec3 transformed;\n\n  // Get the normal\n  ".concat(i.Kb.skinbase_vertex,"\n  ").concat(i.Kb.beginnormal_vertex,"\n  ").concat(i.Kb.skinnormal_vertex,"\n  ").concat(i.Kb.defaultnormal_vertex,"\n\n  // Get the current vertex position\n  transformed = vec3( position );\n  ").concat(i.Kb.skinning_vertex,"\n  newPosition = modelViewMatrix * vec4(transformed, 1.0);\n\n  // Get the previous vertex position\n  transformed = vec3( position );\n  ").concat(i.Kb.skinbase_vertex.replace(/mat4 /g,"").replace(/getBoneMatrix/g,"getPrevBoneMatrix"),"\n  ").concat(i.Kb.skinning_vertex.replace(/vec4 /g,""),"\n  prevPosition = prevModelViewMatrix * vec4(transformed, 1.0);\n\n  // The delta between frames\n  vec3 delta = newPosition.xyz - prevPosition.xyz;\n  vec3 direction = normalize(delta);\n\n  // Stretch along the velocity axes\n  // TODO: Can we combine the stretch and expand\n  float stretchDot = dot(direction, transformedNormal);\n  vec4 expandDir = vec4(direction, 0.0) * stretchDot * expandGeometry * length(delta);\n  vec4 newPosition2 =  projectionMatrix * (newPosition + expandDir);\n  vec4 prevPosition2 = prevProjectionMatrix * (prevPosition + expandDir);\n\n  newPosition =  projectionMatrix * newPosition;\n  prevPosition = prevProjectionMatrix * prevPosition;\n\n  gl_Position = mix(newPosition2, prevPosition2, interpolateGeometry * (1.0 - step(0.0, stretchDot) ) );\n"),tt={uniforms:{prevProjectionMatrix:{value:new i.cb},prevModelViewMatrix:{value:new i.cb},prevBoneTexture:{value:null},expandGeometry:{value:0},interpolateGeometry:{value:1},smearIntensity:{value:1}},vertexShader:"\n    ".concat(i.Kb.skinning_pars_vertex,"\n    ").concat(Ze,"\n\n    uniform mat4 prevProjectionMatrix;\n    uniform mat4 prevModelViewMatrix;\n    uniform float expandGeometry;\n    uniform float interpolateGeometry;\n    varying vec4 prevPosition;\n    varying vec4 newPosition;\n\n    void main() {\n\n      ").concat(et,"\n\n    }\n  "),fragmentShader:"\n    uniform float smearIntensity;\n    varying vec4 prevPosition;\n    varying vec4 newPosition;\n\n    void main() {\n\n      // NOTE: It seems the velociyt is incorrectly calculated here -- see the velocity pass\n      // in shader replacement to see how to compute velocities in screen uv space.\n      vec3 vel;\n      vel = (newPosition.xyz / newPosition.w) - (prevPosition.xyz / prevPosition.w);\n\n      gl_FragColor = vec4(vel * smearIntensity, 1.0);\n    }\n  "},rt={uniforms:{prevProjectionMatrix:{value:new i.cb},prevModelViewMatrix:{value:new i.cb},prevBoneTexture:{value:null},expandGeometry:{value:0},interpolateGeometry:{value:1},smearIntensity:{value:1}},vertexShader:"\n    ".concat(i.Kb.skinning_pars_vertex,"\n    ").concat(Ze,"\n\n    uniform mat4 prevProjectionMatrix;\n    uniform mat4 prevModelViewMatrix;\n    uniform float expandGeometry;\n    uniform float interpolateGeometry;\n    varying vec4 prevPosition;\n    varying vec4 newPosition;\n    varying vec3 color;\n\n    void main() {\n\n      ").concat(et,"\n\n      color = (modelViewMatrix * vec4(normal.xyz, 0)).xyz;\n      color = normalize(color);\n\n    }\n  "),fragmentShader:"\n    varying vec3 color;\n\n    void main() {\n      gl_FragColor = vec4(color, 1);\n    }\n  "},nt={defines:{SAMPLES:30,JITTER_STRATEGY:1,BLUENOISE_SIZE:"32.0"},uniforms:{sourceBuffer:{value:null},velocityBuffer:{value:null},jitter:{value:1},blueNoiseTex:{value:null}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n  ",fragmentShader:"\n    varying vec2 vUv;\n    uniform sampler2D sourceBuffer;\n    uniform sampler2D velocityBuffer;\n    uniform float jitter;\n\n    #if JITTER_STRATEGY == 2 // blue noise\n    uniform sampler2D blueNoiseTex;\n    #endif\n\n    #include <common>\n    void main() {\n\n      vec2 vel = texture2D( velocityBuffer, vUv ).xy;\n\n      #if JITTER_STRATEGY == 0 // Regular Jitter\n      float jitterValue = mod( ( gl_FragCoord.x + gl_FragCoord.y ) * 0.25, 1.0 );\n      #elif JITTER_STRATEGY == 1 // Random Jitter\n      float jitterValue = rand( gl_FragCoord.xy * 0.01 );\n      #elif JITTER_STRATEGY == 2 // Blue Noise Jitter\n      float jitterValue = texture2D( blueNoiseTex, gl_FragCoord.xy / BLUENOISE_SIZE ).r;\n      #endif\n\n      vec2 jitterOffset = jitter * vel * vec2( jitterValue ) / float( SAMPLES );\n      vec4 result;\n\n      vec2 startUv = clamp( vUv - vel * 0.5 + jitterOffset, 0.0, 1.0 );\n      vec2 endUv = clamp( vUv + vel * 0.5 + jitterOffset, 0.0, 1.0 );\n      for( int i = 0; i < SAMPLES; i ++ ) {\n\n        vec2 sampleUv = mix( startUv, endUv, float( i ) / float( SAMPLES ) );\n        result += texture2D( sourceBuffer, sampleUv );\n\n      }\n\n      result /= float( SAMPLES );\n\n      gl_FragColor = result;\n\n    }\n  "};function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t,r){return(at="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pt(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function st(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ct(e,t,r){return t&&st(e.prototype,t),r&&st(e,r),e}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=pt(e);if(t){var o=pt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ft(this,r)}}function ft(e,t){return!t||"object"!==ot(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dt=new i.j(0,0,0),vt={},mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(r,e);var t=lt(r);function r(e,n){var o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return it(this,r),(o=t.call(this)).samples="samples"in a?a.samples:15,o.expandGeometry="expandGeometry"in a?a.expandGeometry:0,o.interpolateGeometry="interpolateGeometry"in a?a.interpolateGeometry:1,o.smearIntensity="smearIntensity"in a?a.smearIntensity:1,o.blurTransparent="blurTransparent"in a&&a.blurTransparent,o.renderCameraBlur=!("renderCameraBlur"in a)||a.renderCameraBlur,o.renderTargetScale="renderTargetScale"in a?a.renderTargetScale:1,o.jitter="jitter"in a?a.jitter:1,o.jitterStrategy="jitterStrategy"in a?a.jitterStrategy:r.RANDOM_JITTER,o.debug={display:r.DEFAULT,dontUpdateState:!1},o.scene=e,o.camera=n,o._prevPosMap=new Map,o._currentFrameMod=0,o._frustum=new i.A,o._projScreenMatrix=new i.cb,o._cameraMatricesNeedInitializing=!0,o._prevCamProjection=new i.cb,o._prevCamWorldInverse=new i.cb,o._velocityBuffer=new i.ic(256*o.renderTargetScale,256*o.renderTargetScale,{minFilter:i.Q,magFilter:i.Q,type:i.D}),o._velocityBuffer.texture.name="MotionBlurPass.Velocity",o._velocityBuffer.texture.generateMipmaps=!1,o._compositeMaterial=new i.Lb(nt),o._compositeQuad=new He.a.FullScreenQuad(o._compositeMaterial),o}return ct(r,[{key:"enabled",get:function(){return this._enabled},set:function(e){!1===e&&(this._prevPosMap.clear(),this._cameraMatricesNeedInitializing=!0),this._enabled=e}}]),ct(r,[{key:"initialize",value:function(e,t,r){t||r!==i.Zb||(this._velocityBuffer.texture.format=i.Eb),void 0!==r&&(this._velocityBuffer.texture.type=r)}},{key:"dispose",value:function(){at(pt(r.prototype),"dispose",this).call(this),this._compositeQuad.dispose(),this._velocityBuffer.dispose(),this._prevPosMap.clear()}},{key:"setSize",value:function(e,t){var r=this.renderTargetScale;this._velocityBuffer.setSize(e*r,t*r)}},{key:"render",value:function(e,t,n){var o=this.debug,i=this.scene,a=this.camera,s=this._compositeQuad,c=this.renderToScreen?null:n;switch(e.autoClear=!1,e.setClearColor(dt,0),e.compile(i,a),this._ensurePrevCameraTransform(),o.display){case r.GEOMETRY:e.setRenderTarget(c),e.clear(),this._drawAllMeshes(e,r.GEOMETRY,!o.dontUpdateState);break;case r.VELOCITY:e.setRenderTarget(c),e.clear(),this._drawAllMeshes(e,r.VELOCITY,!o.dontUpdateState);break;case r.DEFAULT:var u=this._velocityBuffer;e.setRenderTarget(u),e.clear(),this._drawAllMeshes(e,r.VELOCITY,!o.dontUpdateState);var l=this._compositeMaterial,f=l.uniforms;f.sourceBuffer.value=t.texture,f.velocityBuffer.value=this._velocityBuffer.texture,f.jitter.value=this.jitter,l.defines.SAMPLES!==this.samples&&(l.defines.SAMPLES=Math.max(0,Math.floor(this.samples)),l.needsUpdate=!0),l.defines.JITTER_STRATEGY!==this.jitterStrategy&&(l.defines.JITTER_STRATEGY=this.jitterStrategy,l.needsUpdate=!0),e.setRenderTarget(c),s.render(e)}this._prevCamWorldInverse.copy(a.matrixWorldInverse),this._prevCamProjection.copy(a.projectionMatrix)}},{key:"_getPreviousFrameState",value:function(e){var t=this._prevPosMap,r=t.get(e);void 0===r&&(r={lastUsedFrame:-1,matrixWorld:e.matrixWorld.clone(),geometryMaterial:new i.Lb(rt),velocityMaterial:new i.Lb(tt),boneMatrices:null,boneTexture:null},t.set(e,r));var n="SkinnedMesh"===e.type&&e.skeleton&&e.skeleton.bones&&e.skeleton.boneMatrices;r.geometryMaterial.skinning=n,r.velocityMaterial.skinning=n;var o=e.skeleton,a=null===r.boneMatrices||r.boneMatrices.length!==o.boneMatrices.length;if(n&&a){var s=new Float32Array(o.boneMatrices.length);s.set(o.boneMatrices),r.boneMatrices=s;var c=Math.sqrt(o.boneMatrices.length/4),u=new i.n(s,c,c,i.Bb,i.y);u.needsUpdate=!0,r.geometryMaterial.uniforms.prevBoneTexture.value=u,r.velocityMaterial.uniforms.prevBoneTexture.value=u,r.boneTexture=u}return r}},{key:"_saveCurrentObjectState",value:function(e){var t=this._prevPosMap.get(e);null!==t.boneMatrices&&(t.boneMatrices.set(e.skeleton.boneMatrices),t.boneTexture.needsUpdate=!0),t.matrixWorld.copy(e.matrixWorld)}},{key:"_drawAllMeshes",value:function(e,t,r){var n=this;this._currentFrameMod=(this._currentFrameMod+1)%2;var o=this._currentFrameMod,i=this._prevPosMap;!function e(t,r){if(t.visible){(t.isMesh||t.isSkinnedMesh)&&r(t);for(var n=t.children,o=0,i=n.length;o<i;o++)e(n[o],r)}}(this.scene,(function(a){n._drawMesh(e,a,t,r),i.has(a)&&(i.get(a).lastUsedFrame=o)})),i.forEach((function(e,t){e.lastUsedFrame!==o&&(e.geometryMaterial.dispose(),e.velocityMaterial.dispose(),e.boneTexture&&e.boneTexture.dispose(),i.delete(t))}))}},{key:"_drawMesh",value:function(e,t,n,o){var i=t.motionBlur||vt,a=this.blurTransparent,s=this.renderCameraBlur,c=this.expandGeometry,u=this.interpolateGeometry,l=this.smearIntensity;a="blurTransparent"in i?i.blurTransparent:this.blurTransparent,s="renderCameraBlur"in i?i.renderCameraBlur:this.renderCameraBlur,c="expandGeometry"in i?i.expandGeometry:this.expandGeometry,u="interpolateGeometry"in i?i.interpolateGeometry:this.interpolateGeometry,l="smearIntensity"in i?i.smearIntensity:this.smearIntensity;var f=t.material.transparent||t.material.alpha<1,p=t.frustumCulled&&!this._frustum.intersectsObject(t);if(!1===a&&f||p)this._prevPosMap.has(t)&&o&&this._saveCurrentObjectState(t);else{var d=this.camera,v=this._getPreviousFrameState(t),m=n===r.GEOMETRY?v.geometryMaterial:v.velocityMaterial,h=m.uniforms;h.expandGeometry.value=c,h.interpolateGeometry.value=u,h.smearIntensity.value=l;var y=s?this._prevCamProjection:d.projectionMatrix,g=s?this._prevCamWorldInverse:d.matrixWorldInverse;h.prevProjectionMatrix.value.copy(y),h.prevModelViewMatrix.value.multiplyMatrices(g,v.matrixWorld),e.renderBufferDirect(d,null,t.geometry,m,t,null),o&&this._saveCurrentObjectState(t)}}},{key:"_ensurePrevCameraTransform",value:function(){var e=this.camera,t=this._projScreenMatrix;this._cameraMatricesNeedInitializing&&(this._prevCamWorldInverse.copy(e.matrixWorldInverse),this._prevCamProjection.copy(e.projectionMatrix),this._cameraMatricesNeedInitializing=!1),t.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(t)}}]),r}(o.c);mt.DEFAULT=0,mt.VELOCITY=1,mt.GEOMETRY=2,mt.REGULAR_JITTER=0,mt.RANDOM_JITTER=1,window.DEBUG=window.location.search.includes("debug");var ht=new K({canvas:document.querySelector("#app"),alpha:!0,background:"#111",backgroundAlpha:1,gamma:!0,postprocessing:!0,maxPixelRatio:1,showFps:window.DEBUG,orbitControls:window.DEBUG,controls:{roughness:.5,movement:{speed:{value:1.5,max:100,scale:"exp"},frequency:{value:.5,max:5},amplitude:{value:.7,max:2}}},hideControls:!window.DEBUG});window.DEBUG&&(window.webgl=ht),ht.canvas.style.visibility="hidden",Ie.load({renderer:ht.renderer}).then((function(){var e,t;ht.canvas.style.visibility="",ht.scene.suzanne=new Qe(ht),ht.scene.add(ht.scene.suzanne),function(e){var t=new i.E(16777215,16777215,.6);t.color.setHSL(.6,1,.6),t.groundColor.setHSL(.095,1,.75),t.position.set(0,50,0),e.scene.add(t);var r=new i.t(16777215,1);r.color.setHSL(.1,1,.95),r.position.set(3,5,1),r.position.multiplyScalar(50),e.scene.add(r)}(ht),ht.composer.addPass(new o.b(ht.camera,new o.e)),window.DEBUG&&(e=ht,(t=document.createElement("div")).style.position="fixed",t.style.bottom=0,t.style.right=0,t.style.background="tomato",t.style.cursor="pointer",t.style.padding="8px 16px",t.style.margin="12px",t.style.borderRadius="3px",t.style.color="white",t.style.fontSize="24px",t.textContent="\ud83d\udcf8 Save screenshot",t.addEventListener("click",e.saveScreenshot),document.body.appendChild(t),function(e){var t=document.createElement("div");t.style.position="fixed",t.style.bottom=0,t.style.left=0,t.style.background="tomato",t.style.cursor="pointer",t.style.padding="8px 16px",t.style.margin="12px",t.style.borderRadius="3px",t.style.color="white",t.style.fontSize="24px",t.textContent="\ud83d\udd34 Start recording gif",t.addEventListener("click",(function(){e.isRecording?(e.stopRecording(),t.textContent="\ud83d\udd34 Start recording gif"):(e.startRecording(),t.textContent="\ud83d\udfe5 Stop recording gif")})),document.body.appendChild(t)}(ht)),ht.start()}))}});
//# sourceMappingURL=app.401ab3f5.js.map